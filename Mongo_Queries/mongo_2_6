use football;
db.getCollection('teams').aggregate([{$lookup:{from:"teams",let:{"bId":"$_id","bTeam":"$team","bgoalsFor":"$goalsFor","bgoalsAgainst":"$goalsAgainst"},pipeline:[{$match:{$and:[{$expr:{$lt:["$_id","$$bId"]}},{$expr:{$ne:["$team","$$bTeam"]}},{$expr:{$eq:["$goalsFor","$$bgoalsFor"]}},{$expr:{$eq:["$goalsAgainst","$$bgoalsAgainst"]}}]}}],as:"team2"}},{$unwind:"$team2"},{$addFields:{"against_team":"$team2.team"}},{$project:{"team":1,"goalsFor":1,"goalsAgainst":1,"against_team":1}}]).pretty();